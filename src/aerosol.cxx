// Copyright (C) 2022  Fernando García Liñán
//
// Permission is hereby granted, free of charge, to any person obtaining
// a copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to
// permit persons to whom the Software is furnished to do so, subject to
// the following conditions:
//
// The above copyright notice and this permission notice shall be
// included in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

#include "aerosol.hxx"

#include "lut.hxx"

//------------------------------------------------------------------------------

static const LookupTable background_absorption_cross_section = {
    {360.0f, 9.8406e-19f},
    {370.0f, 9.6844e-19f},
    {380.0f, 9.3266e-19f},
    {390.0f, 9.0152e-19f},
    {400.0f, 8.8336e-19f},
    {410.0f, 8.7412e-19f},
    {420.0f, 8.6551e-19f},
    {430.0f, 8.5143e-19f},
    {440.0f, 8.2828e-19f},
    {450.0f, 7.9693e-19f},
    {460.0f, 7.6559e-19f},
    {470.0f, 7.3590e-19f},
    {480.0f, 7.1088e-19f},
    {490.0f, 6.9105e-19f},
    {500.0f, 6.7537e-19f},
    {510.0f, 6.6271e-19f},
    {520.0f, 6.5103e-19f},
    {530.0f, 6.3901e-19f},
    {540.0f, 6.2566e-19f},
    {550.0f, 6.1033e-19f},
    {560.0f, 5.9223e-19f},
    {570.0f, 5.7222e-19f},
    {580.0f, 5.5103e-19f},
    {590.0f, 5.2946e-19f},
    {600.0f, 5.0836e-19f},
    {610.0f, 4.8880e-19f},
    {620.0f, 4.7075e-19f},
    {630.0f, 4.5441e-19f},
    {640.0f, 4.3976e-19f},
    {650.0f, 4.2670e-19f},
    {660.0f, 4.1485e-19f},
    {670.0f, 4.0413e-19f},
    {680.0f, 3.9433e-19f},
    {690.0f, 3.8517e-19f},
    {700.0f, 3.7646e-19f},
    {710.0f, 3.6802e-19f},
    {720.0f, 3.5966e-19f},
    {730.0f, 3.5130e-19f},
    {740.0f, 3.4282e-19f},
    {750.0f, 3.3416e-19f},
    {760.0f, 3.2545e-19f},
    {770.0f, 3.1653e-19f},
    {780.0f, 3.0742e-19f},
    {790.0f, 2.9816e-19f},
    {800.0f, 2.8878e-19f},
    {810.0f, 2.7929e-19f},
    {820.0f, 2.6982e-19f},
    {830.0f, 2.6044e-19f},
};

static const LookupTable background_scattering_cross_section = {
    {360.0f, 2.6693e-26f},
    {370.0f, 2.6623e-26f},
    {380.0f, 2.5321e-26f},
    {390.0f, 2.3630e-26f},
    {400.0f, 2.2338e-26f},
    {410.0f, 2.1618e-26f},
    {420.0f, 2.1301e-26f},
    {430.0f, 2.1151e-26f},
    {440.0f, 2.0912e-26f},
    {450.0f, 2.0410e-26f},
    {460.0f, 1.9703e-26f},
    {470.0f, 1.8881e-26f},
    {480.0f, 1.8090e-26f},
    {490.0f, 1.7423e-26f},
    {500.0f, 1.6908e-26f},
    {510.0f, 1.6534e-26f},
    {520.0f, 1.6268e-26f},
    {530.0f, 1.6072e-26f},
    {540.0f, 1.5906e-26f},
    {550.0f, 1.5775e-26f},
    {560.0f, 1.6980e-26f},
    {570.0f, 1.8122e-26f},
    {580.0f, 1.9132e-26f},
    {590.0f, 2.0008e-26f},
    {600.0f, 2.0734e-26f},
    {610.0f, 2.0122e-26f},
    {620.0f, 1.9493e-26f},
    {630.0f, 1.8893e-26f},
    {640.0f, 1.8336e-26f},
    {650.0f, 1.7858e-26f},
    {660.0f, 1.9117e-26f},
    {670.0f, 2.0378e-26f},
    {680.0f, 2.1634e-26f},
    {690.0f, 2.2892e-26f},
    {700.0f, 2.4351e-26f},
    {710.0f, 3.8588e-26f},
    {720.0f, 5.2703e-26f},
    {730.0f, 6.6569e-26f},
    {740.0f, 8.0202e-26f},
    {750.0f, 9.3825e-26f},
    {760.0f, 1.2704e-25f},
    {770.0f, 1.5978e-25f},
    {780.0f, 1.9176e-25f},
    {790.0f, 2.2289e-25f},
    {800.0f, 2.5250e-25f},
    {810.0f, 2.4468e-25f},
    {820.0f, 2.3627e-25f},
    {830.0f, 2.2783e-25f},
};

float
BackgroundAerosol::get_density(float height) const
{
    // Special case, no dependency on height
    return _base_density * (1.0 + _background_divided_by_base_density);
}

float
BackgroundAerosol::get_absorption_cross_section(float wl) const
{
    return lut_lerp(background_absorption_cross_section, wl);
}

float
BackgroundAerosol::get_scattering_cross_section(float wl) const
{
    return lut_lerp(background_scattering_cross_section, wl);
}

//------------------------------------------------------------------------------

static const LookupTable desert_dust_absorption_cross_section = {
    {360.0f, 4.1273e-16f},
    {370.0f, 4.1287e-16f},
    {380.0f, 4.1298e-16f},
    {390.0f, 4.1312e-16f},
    {400.0f, 4.1345e-16f},
    {410.0f, 4.1373e-16f},
    {420.0f, 4.1380e-16f},
    {430.0f, 4.1492e-16f},
    {440.0f, 4.1562e-16f},
    {450.0f, 4.1699e-16f},
    {460.0f, 4.1868e-16f},
    {470.0f, 4.1810e-16f},
    {480.0f, 4.2080e-16f},
    {490.0f, 4.1986e-16f},
    {500.0f, 4.2291e-16f},
    {510.0f, 4.2402e-16f},
    {520.0f, 4.2776e-16f},
    {530.0f, 4.3358e-16f},
    {540.0f, 4.3448e-16f},
    {550.0f, 4.4695e-16f},
    {560.0f, 4.4645e-16f},
    {570.0f, 4.5019e-16f},
    {580.0f, 4.6188e-16f},
    {590.0f, 4.5954e-16f},
    {600.0f, 4.6552e-16f},
    {610.0f, 4.7575e-16f},
    {620.0f, 4.7034e-16f},
    {630.0f, 4.6794e-16f},
    {640.0f, 4.7937e-16f},
    {650.0f, 4.8121e-16f},
    {660.0f, 4.7506e-16f},
    {670.0f, 4.8124e-16f},
    {680.0f, 4.9612e-16f},
    {690.0f, 4.9827e-16f},
    {700.0f, 4.9147e-16f},
    {710.0f, 4.9394e-16f},
    {720.0f, 5.0729e-16f},
    {730.0f, 5.1219e-16f},
    {740.0f, 5.0358e-16f},
    {750.0f, 4.9739e-16f},
    {760.0f, 5.2279e-16f},
    {770.0f, 5.6035e-16f},
    {780.0f, 5.9223e-16f},
    {790.0f, 6.1249e-16f},
    {800.0f, 6.3642e-16f},
    {810.0f, 6.4141e-16f},
    {820.0f, 6.6077e-16f},
    {830.0f, 6.7588e-16f},
};

static const LookupTable desert_dust_scattering_cross_section = {
    {360.0f, 3.4215e-16f},
    {370.0f, 3.4240e-16f},
    {380.0f, 3.4266e-16f},
    {390.0f, 3.4288e-16f},
    {400.0f, 3.4308e-16f},
    {410.0f, 3.4320e-16f},
    {420.0f, 3.4319e-16f},
    {430.0f, 3.4296e-16f},
    {440.0f, 3.4234e-16f},
    {450.0f, 3.4110e-16f},
    {460.0f, 3.4069e-16f},
    {470.0f, 3.4022e-16f},
    {480.0f, 3.3966e-16f},
    {490.0f, 3.3900e-16f},
    {500.0f, 3.3824e-16f},
    {510.0f, 3.3598e-16f},
    {520.0f, 3.3303e-16f},
    {530.0f, 3.2921e-16f},
    {540.0f, 3.2435e-16f},
    {550.0f, 3.1835e-16f},
    {560.0f, 3.1454e-16f},
    {570.0f, 3.1042e-16f},
    {580.0f, 3.0589e-16f},
    {590.0f, 3.0092e-16f},
    {600.0f, 2.9559e-16f},
    {610.0f, 2.9413e-16f},
    {620.0f, 2.9275e-16f},
    {630.0f, 2.9137e-16f},
    {640.0f, 2.8999e-16f},
    {650.0f, 2.8859e-16f},
    {660.0f, 2.8490e-16f},
    {670.0f, 2.8105e-16f},
    {680.0f, 2.7707e-16f},
    {690.0f, 2.7296e-16f},
    {700.0f, 2.6875e-16f},
    {710.0f, 2.6727e-16f},
    {720.0f, 2.6584e-16f},
    {730.0f, 2.6441e-16f},
    {740.0f, 2.6301e-16f},
    {750.0f, 2.6143e-16f},
    {760.0f, 2.4192e-16f},
    {770.0f, 2.1835e-16f},
    {780.0f, 1.9026e-16f},
    {790.0f, 1.5663e-16f},
    {800.0f, 1.1720e-16f},
    {810.0f, 1.1560e-16f},
    {820.0f, 1.1457e-16f},
    {830.0f, 1.1362e-16f},
};

float
DesertDustAerosol::get_absorption_cross_section(float wl) const
{
    return lut_lerp(desert_dust_absorption_cross_section, wl);
}

float
DesertDustAerosol::get_scattering_cross_section(float wl) const
{
    return lut_lerp(desert_dust_scattering_cross_section, wl);
}

//------------------------------------------------------------------------------

static const LookupTable maritime_clean_absorption_cross_section = {
    {360.0f, 1.1407e-18f},
    {370.0f, 1.1330e-18f},
    {380.0f, 1.1390e-18f},
    {390.0f, 1.1418e-18f},
    {400.0f, 1.1295e-18f},
    {410.0f, 1.1023e-18f},
    {420.0f, 1.0679e-18f},
    {430.0f, 1.0379e-18f},
    {440.0f, 1.0164e-18f},
    {450.0f, 1.0008e-18f},
    {460.0f, 9.8781e-19f},
    {470.0f, 9.7218e-19f},
    {480.0f, 9.5159e-19f},
    {490.0f, 9.2565e-19f},
    {500.0f, 8.9595e-19f},
    {510.0f, 8.6538e-19f},
    {520.0f, 8.3662e-19f},
    {530.0f, 8.1135e-19f},
    {540.0f, 7.8993e-19f},
    {550.0f, 7.7169e-19f},
    {560.0f, 7.5529e-19f},
    {570.0f, 7.3988e-19f},
    {580.0f, 7.2449e-19f},
    {590.0f, 7.0837e-19f},
    {600.0f, 6.9104e-19f},
    {610.0f, 6.7256e-19f},
    {620.0f, 6.5280e-19f},
    {630.0f, 6.3209e-19f},
    {640.0f, 6.1085e-19f},
    {650.0f, 5.8965e-19f},
    {660.0f, 5.6904e-19f},
    {670.0f, 5.4936e-19f},
    {680.0f, 5.3092e-19f},
    {690.0f, 5.1384e-19f},
    {700.0f, 4.9818e-19f},
    {710.0f, 4.8390e-19f},
    {720.0f, 4.7083e-19f},
    {730.0f, 4.5883e-19f},
    {740.0f, 4.4772e-19f},
    {750.0f, 4.3731e-19f},
    {760.0f, 4.2744e-19f},
    {770.0f, 4.1794e-19f},
    {780.0f, 4.0870e-19f},
    {790.0f, 3.9959e-19f},
    {800.0f, 3.9053e-19f},
    {810.0f, 3.8165e-19f},
    {820.0f, 3.7268e-19f},
    {830.0f, 3.6364e-19f},
};

static const LookupTable maritime_clean_scattering_cross_section = {
    {360.0f, 4.1604e-25f},
    {370.0f, 3.1545e-25f},
    {380.0f, 2.2915e-25f},
    {390.0f, 1.4609e-25f},
    {400.0f, 6.3309e-26f},
    {410.0f, 6.1617e-26f},
    {420.0f, 5.9039e-26f},
    {430.0f, 5.6123e-26f},
    {440.0f, 5.3725e-26f},
    {450.0f, 5.2075e-26f},
    {460.0f, 4.9044e-26f},
    {470.0f, 4.6354e-26f},
    {480.0f, 4.3753e-26f},
    {490.0f, 4.1042e-26f},
    {500.0f, 3.8148e-26f},
    {510.0f, 3.5549e-26f},
    {520.0f, 3.2924e-26f},
    {530.0f, 3.0407e-26f},
    {540.0f, 2.8091e-26f},
    {550.0f, 2.6095e-26f},
    {560.0f, 2.7241e-26f},
    {570.0f, 2.8549e-26f},
    {580.0f, 2.9915e-26f},
    {590.0f, 3.1317e-26f},
    {600.0f, 3.2782e-26f},
    {610.0f, 3.7658e-26f},
    {620.0f, 4.2354e-26f},
    {630.0f, 4.6746e-26f},
    {640.0f, 5.0807e-26f},
    {650.0f, 5.4661e-26f},
    {660.0f, 6.8246e-26f},
    {670.0f, 8.1149e-26f},
    {680.0f, 9.3319e-26f},
    {690.0f, 1.0487e-25f},
    {700.0f, 1.2113e-25f},
    {710.0f, 4.7818e-25f},
    {720.0f, 8.2565e-25f},
    {730.0f, 1.1612e-24f},
    {740.0f, 1.4870e-24f},
    {750.0f, 2.0030e-24f},
    {760.0f, 2.0886e-23f},
    {770.0f, 3.9477e-23f},
    {780.0f, 5.7646e-23f},
    {790.0f, 7.5443e-23f},
    {800.0f, 9.2504e-23f},
    {810.0f, 8.4882e-23f},
    {820.0f, 7.7075e-23f},
    {830.0f, 6.9406e-23f},
};

float
MaritimeCleanAerosol::get_absorption_cross_section(float wl) const
{
    return lut_lerp(maritime_clean_absorption_cross_section, wl);
}

float
MaritimeCleanAerosol::get_scattering_cross_section(float wl) const
{
    return lut_lerp(maritime_clean_scattering_cross_section, wl);
}

//------------------------------------------------------------------------------

static const LookupTable maritime_mineral_absorption_cross_section = {
    {360.0f, 8.0014e-19f},
    {370.0f, 8.1083e-19f},
    {380.0f, 7.9638e-19f},
    {390.0f, 8.0396e-19f},
    {400.0f, 8.3047e-19f},
    {410.0f, 8.5998e-19f},
    {420.0f, 8.8404e-19f},
    {430.0f, 8.9077e-19f},
    {440.0f, 8.7521e-19f},
    {450.0f, 8.5209e-19f},
    {460.0f, 8.3212e-19f},
    {470.0f, 8.2397e-19f},
    {480.0f, 8.2292e-19f},
    {490.0f, 8.2426e-19f},
    {500.0f, 8.2436e-19f},
    {510.0f, 8.2818e-19f},
    {520.0f, 8.2552e-19f},
    {530.0f, 8.1530e-19f},
    {540.0f, 7.9915e-19f},
    {550.0f, 7.8053e-19f},
    {560.0f, 7.5904e-19f},
    {570.0f, 7.4148e-19f},
    {580.0f, 7.2814e-19f},
    {590.0f, 7.1821e-19f},
    {600.0f, 7.1063e-19f},
    {610.0f, 7.0474e-19f},
    {620.0f, 6.9924e-19f},
    {630.0f, 6.9334e-19f},
    {640.0f, 6.8645e-19f},
    {650.0f, 6.7818e-19f},
    {660.0f, 6.6889e-19f},
    {670.0f, 6.5796e-19f},
    {680.0f, 6.4555e-19f},
    {690.0f, 6.3201e-19f},
    {700.0f, 6.1779e-19f},
    {710.0f, 6.0221e-19f},
    {720.0f, 5.8704e-19f},
    {730.0f, 5.7261e-19f},
    {740.0f, 5.5912e-19f},
    {750.0f, 5.4651e-19f},
    {760.0f, 5.2556e-19f},
    {770.0f, 5.0669e-19f},
    {780.0f, 4.8960e-19f},
    {790.0f, 4.7394e-19f},
    {800.0f, 4.5957e-19f},
    {810.0f, 4.5403e-19f},
    {820.0f, 4.4875e-19f},
    {830.0f, 4.4361e-19f},
};

static const LookupTable maritime_mineral_scattering_cross_section = {
    {360.0f, 2.0079e-19f},
    {370.0f, 2.0119e-19f},
    {380.0f, 1.9897e-19f},
    {390.0f, 1.9722e-19f},
    {400.0f, 1.9672e-19f},
    {410.0f, 1.9837e-19f},
    {420.0f, 2.0038e-19f},
    {430.0f, 2.0217e-19f},
    {440.0f, 2.0302e-19f},
    {450.0f, 2.0312e-19f},
    {460.0f, 2.0766e-19f},
    {470.0f, 2.1207e-19f},
    {480.0f, 2.1660e-19f},
    {490.0f, 2.2137e-19f},
    {500.0f, 2.2630e-19f},
    {510.0f, 2.2638e-19f},
    {520.0f, 2.2622e-19f},
    {530.0f, 2.2554e-19f},
    {540.0f, 2.2427e-19f},
    {550.0f, 2.2273e-19f},
    {560.0f, 2.2443e-19f},
    {570.0f, 2.2612e-19f},
    {580.0f, 2.2787e-19f},
    {590.0f, 2.2977e-19f},
    {600.0f, 2.3180e-19f},
    {610.0f, 2.3353e-19f},
    {620.0f, 2.3532e-19f},
    {630.0f, 2.3707e-19f},
    {640.0f, 2.3875e-19f},
    {650.0f, 2.4026e-19f},
    {660.0f, 2.4115e-19f},
    {670.0f, 2.4178e-19f},
    {680.0f, 2.4214e-19f},
    {690.0f, 2.4222e-19f},
    {700.0f, 2.4208e-19f},
    {710.0f, 2.4278e-19f},
    {720.0f, 2.4331e-19f},
    {730.0f, 2.4372e-19f},
    {740.0f, 2.4406e-19f},
    {750.0f, 2.4448e-19f},
    {760.0f, 2.5298e-19f},
    {770.0f, 2.6081e-19f},
    {780.0f, 2.6802e-19f},
    {790.0f, 2.7470e-19f},
    {800.0f, 2.8080e-19f},
    {810.0f, 2.7877e-19f},
    {820.0f, 2.7674e-19f},
    {830.0f, 2.7481e-19f},
};

float
MaritimeMineralAerosol::get_absorption_cross_section(float wl) const
{
    return lut_lerp(maritime_mineral_absorption_cross_section, wl);
}

float
MaritimeMineralAerosol::get_scattering_cross_section(float wl) const
{
    return lut_lerp(maritime_mineral_scattering_cross_section, wl);
}

//------------------------------------------------------------------------------

static const LookupTable polar_antarctic_absorption_cross_section = {
    {360.0f, 1.2793e-16f},
    {370.0f, 1.2025e-16f},
    {380.0f, 1.2165e-16f},
    {390.0f, 1.2959e-16f},
    {400.0f, 1.2100e-16f},
    {410.0f, 1.1902e-16f},
    {420.0f, 1.2724e-16f},
    {430.0f, 1.3034e-16f},
    {440.0f, 1.2337e-16f},
    {450.0f, 1.1795e-16f},
    {460.0f, 1.2184e-16f},
    {470.0f, 1.3063e-16f},
    {480.0f, 1.2992e-16f},
    {490.0f, 1.2885e-16f},
    {500.0f, 1.1966e-16f},
    {510.0f, 1.1888e-16f},
    {520.0f, 1.2233e-16f},
    {530.0f, 1.2532e-16f},
    {540.0f, 1.2956e-16f},
    {550.0f, 1.3270e-16f},
    {560.0f, 1.3187e-16f},
    {570.0f, 1.2739e-16f},
    {580.0f, 1.2228e-16f},
    {590.0f, 1.1996e-16f},
    {600.0f, 1.2148e-16f},
    {610.0f, 1.2584e-16f},
    {620.0f, 1.3100e-16f},
    {630.0f, 1.3458e-16f},
    {640.0f, 1.3480e-16f},
    {650.0f, 1.3196e-16f},
    {660.0f, 1.2931e-16f},
    {670.0f, 1.2813e-16f},
    {680.0f, 1.2418e-16f},
    {690.0f, 1.1743e-16f},
    {700.0f, 1.1532e-16f},
    {710.0f, 1.2077e-16f},
    {720.0f, 1.2188e-16f},
    {730.0f, 1.2281e-16f},
    {740.0f, 1.3243e-16f},
    {750.0f, 1.3369e-16f},
    {760.0f, 1.3547e-16f},
    {770.0f, 1.3975e-16f},
    {780.0f, 1.3507e-16f},
    {790.0f, 1.3863e-16f},
    {800.0f, 1.3196e-16f},
    {810.0f, 1.3171e-16f},
    {820.0f, 1.2558e-16f},
    {830.0f, 1.2358e-16f},
};

static const LookupTable polar_antarctic_scattering_cross_section = {
    {360.0f, 2.7803e-19f},
    {370.0f, 2.7704e-19f},
    {380.0f, 2.7558e-19f},
    {390.0f, 2.7375e-19f},
    {400.0f, 2.7140e-19f},
    {410.0f, 2.6801e-19f},
    {420.0f, 2.6351e-19f},
    {430.0f, 2.5776e-19f},
    {440.0f, 2.5066e-19f},
    {450.0f, 2.4211e-19f},
    {460.0f, 2.3934e-19f},
    {470.0f, 2.3648e-19f},
    {480.0f, 2.3386e-19f},
    {490.0f, 2.3061e-19f},
    {500.0f, 2.2773e-19f},
    {510.0f, 2.2073e-19f},
    {520.0f, 2.1250e-19f},
    {530.0f, 2.0445e-19f},
    {540.0f, 1.9599e-19f},
    {550.0f, 1.8646e-19f},
    {560.0f, 1.8067e-19f},
    {570.0f, 1.7481e-19f},
    {580.0f, 1.6910e-19f},
    {590.0f, 1.6347e-19f},
    {600.0f, 1.5798e-19f},
    {610.0f, 1.5671e-19f},
    {620.0f, 1.5573e-19f},
    {630.0f, 1.5490e-19f},
    {640.0f, 1.5337e-19f},
    {650.0f, 1.5101e-19f},
    {660.0f, 1.4668e-19f},
    {670.0f, 1.4351e-19f},
    {680.0f, 1.4174e-19f},
    {690.0f, 1.3790e-19f},
    {700.0f, 1.3280e-19f},
    {710.0f, 1.3264e-19f},
    {720.0f, 1.3298e-19f},
    {730.0f, 1.3036e-19f},
    {740.0f, 1.2985e-19f},
    {750.0f, 1.2998e-19f},
    {760.0f, 1.1517e-19f},
    {770.0f, 1.0151e-19f},
    {780.0f, 8.4163e-20f},
    {790.0f, 6.8461e-20f},
    {800.0f, 5.0112e-20f},
    {810.0f, 4.9712e-20f},
    {820.0f, 4.8420e-20f},
    {830.0f, 4.7737e-20f},
};

float
PolarAntarcticAerosol::get_absorption_cross_section(float wl) const
{
    return lut_lerp(polar_antarctic_absorption_cross_section, wl);
}

float
PolarAntarcticAerosol::get_scattering_cross_section(float wl) const
{
    return lut_lerp(polar_antarctic_scattering_cross_section, wl);
}

//------------------------------------------------------------------------------

static const LookupTable polar_artic_absorption_cross_section = {
    {360.0f, 9.6157e-17f},
    {370.0f, 9.5519e-17f},
    {380.0f, 9.7479e-17f},
    {390.0f, 9.8208e-17f},
    {400.0f, 9.4749e-17f},
    {410.0f, 9.5596e-17f},
    {420.0f, 1.0006e-16f},
    {430.0f, 1.0106e-16f},
    {440.0f, 9.7475e-17f},
    {450.0f, 9.5479e-17f},
    {460.0f, 9.7784e-17f},
    {470.0f, 1.0136e-16f},
    {480.0f, 1.0275e-16f},
    {490.0f, 1.0184e-16f},
    {500.0f, 9.9258e-17f},
    {510.0f, 9.8836e-17f},
    {520.0f, 9.9029e-17f},
    {530.0f, 1.0000e-16f},
    {540.0f, 1.0242e-16f},
    {550.0f, 1.0481e-16f},
    {560.0f, 1.0609e-16f},
    {570.0f, 1.0619e-16f},
    {580.0f, 1.0535e-16f},
    {590.0f, 1.0424e-16f},
    {600.0f, 1.0330e-16f},
    {610.0f, 1.0279e-16f},
    {620.0f, 1.0311e-16f},
    {630.0f, 1.0397e-16f},
    {640.0f, 1.0508e-16f},
    {650.0f, 1.0641e-16f},
    {660.0f, 1.0838e-16f},
    {670.0f, 1.1014e-16f},
    {680.0f, 1.0913e-16f},
    {690.0f, 1.0644e-16f},
    {700.0f, 1.0540e-16f},
    {710.0f, 1.0513e-16f},
    {720.0f, 1.0292e-16f},
    {730.0f, 1.0301e-16f},
    {740.0f, 1.0464e-16f},
    {750.0f, 1.0469e-16f},
    {760.0f, 1.0765e-16f},
    {770.0f, 1.0912e-16f},
    {780.0f, 1.1142e-16f},
    {790.0f, 1.1316e-16f},
    {800.0f, 1.1431e-16f},
    {810.0f, 1.1399e-16f},
    {820.0f, 1.1325e-16f},
    {830.0f, 1.1207e-16f},
};

static const LookupTable polar_artic_scattering_cross_section = {
    {360.0f, 2.7162e-17f},
    {370.0f, 2.7136e-17f},
    {380.0f, 2.7086e-17f},
    {390.0f, 2.7018e-17f},
    {400.0f, 2.6923e-17f},
    {410.0f, 2.6776e-17f},
    {420.0f, 2.6575e-17f},
    {430.0f, 2.6310e-17f},
    {440.0f, 2.5977e-17f},
    {450.0f, 2.5572e-17f},
    {460.0f, 2.5456e-17f},
    {470.0f, 2.5335e-17f},
    {480.0f, 2.5226e-17f},
    {490.0f, 2.5085e-17f},
    {500.0f, 2.4964e-17f},
    {510.0f, 2.4637e-17f},
    {520.0f, 2.4249e-17f},
    {530.0f, 2.3870e-17f},
    {540.0f, 2.3470e-17f},
    {550.0f, 2.3017e-17f},
    {560.0f, 2.2748e-17f},
    {570.0f, 2.2476e-17f},
    {580.0f, 2.2212e-17f},
    {590.0f, 2.1952e-17f},
    {600.0f, 2.1698e-17f},
    {610.0f, 2.1654e-17f},
    {620.0f, 2.1624e-17f},
    {630.0f, 2.1602e-17f},
    {640.0f, 2.1544e-17f},
    {650.0f, 2.1445e-17f},
    {660.0f, 2.1248e-17f},
    {670.0f, 2.1110e-17f},
    {680.0f, 2.1042e-17f},
    {690.0f, 2.0870e-17f},
    {700.0f, 2.0634e-17f},
    {710.0f, 2.0637e-17f},
    {720.0f, 2.0666e-17f},
    {730.0f, 2.0548e-17f},
    {740.0f, 2.0532e-17f},
    {750.0f, 2.0552e-17f},
    {760.0f, 1.9827e-17f},
    {770.0f, 1.9164e-17f},
    {780.0f, 1.8316e-17f},
    {790.0f, 1.7543e-17f},
    {800.0f, 1.6646e-17f},
    {810.0f, 1.6639e-17f},
    {820.0f, 1.6601e-17f},
    {830.0f, 1.6584e-17f},
};

float
PolarArticAerosol::get_absorption_cross_section(float wl) const
{
    return lut_lerp(polar_artic_absorption_cross_section, wl);
}

float
PolarArticAerosol::get_scattering_cross_section(float wl) const
{
    return lut_lerp(polar_artic_scattering_cross_section, wl);
}

//------------------------------------------------------------------------------

static const LookupTable remote_continental_absorption_cross_section = {
    {360.0f, 4.7080e-18f},
    {370.0f, 4.6009e-18f},
    {380.0f, 4.3821e-18f},
    {390.0f, 4.2564e-18f},
    {400.0f, 4.0330e-18f},
    {410.0f, 3.9339e-18f},
    {420.0f, 3.8904e-18f},
    {430.0f, 3.8009e-18f},
    {440.0f, 3.9498e-18f},
    {450.0f, 3.9069e-18f},
    {460.0f, 4.0998e-18f},
    {470.0f, 4.2943e-18f},
    {480.0f, 4.2700e-18f},
    {490.0f, 4.4910e-18f},
    {500.0f, 4.6961e-18f},
    {510.0f, 4.6750e-18f},
    {520.0f, 4.8831e-18f},
    {530.0f, 5.0448e-18f},
    {540.0f, 5.1300e-18f},
    {550.0f, 5.0362e-18f},
    {560.0f, 5.0640e-18f},
    {570.0f, 5.0834e-18f},
    {580.0f, 5.0701e-18f},
    {590.0f, 4.8235e-18f},
    {600.0f, 4.7731e-18f},
    {610.0f, 4.6247e-18f},
    {620.0f, 4.6296e-18f},
    {630.0f, 4.5186e-18f},
    {640.0f, 4.2952e-18f},
    {650.0f, 4.2097e-18f},
    {660.0f, 4.0163e-18f},
    {670.0f, 3.9599e-18f},
    {680.0f, 3.9624e-18f},
    {690.0f, 3.8539e-18f},
    {700.0f, 3.7259e-18f},
    {710.0f, 3.6598e-18f},
    {720.0f, 3.4921e-18f},
    {730.0f, 3.4085e-18f},
    {740.0f, 3.4380e-18f},
    {750.0f, 3.4781e-18f},
    {760.0f, 3.4317e-18f},
    {770.0f, 3.4025e-18f},
    {780.0f, 3.3967e-18f},
    {790.0f, 3.3107e-18f},
    {800.0f, 3.2626e-18f},
    {810.0f, 3.3098e-18f},
    {820.0f, 3.4030e-18f},
    {830.0f, 3.5067e-18f},
};

static const LookupTable remote_continental_scattering_cross_section = {
    {360.0f, 1.5598e-18f},
    {370.0f, 1.5131e-18f},
    {380.0f, 1.5240e-18f},
    {390.0f, 1.5023e-18f},
    {400.0f, 1.4993e-18f},
    {410.0f, 1.4987e-18f},
    {420.0f, 1.5495e-18f},
    {430.0f, 1.4878e-18f},
    {440.0f, 1.5197e-18f},
    {450.0f, 1.4702e-18f},
    {460.0f, 1.5695e-18f},
    {470.0f, 1.6782e-18f},
    {480.0f, 1.6268e-18f},
    {490.0f, 1.6886e-18f},
    {500.0f, 1.7823e-18f},
    {510.0f, 1.7108e-18f},
    {520.0f, 1.7581e-18f},
    {530.0f, 1.6921e-18f},
    {540.0f, 1.7357e-18f},
    {550.0f, 1.7035e-18f},
    {560.0f, 1.7432e-18f},
    {570.0f, 1.7242e-18f},
    {580.0f, 1.7989e-18f},
    {590.0f, 1.7985e-18f},
    {600.0f, 1.8695e-18f},
    {610.0f, 1.7962e-18f},
    {620.0f, 1.8295e-18f},
    {630.0f, 1.8771e-18f},
    {640.0f, 1.8970e-18f},
    {650.0f, 1.9480e-18f},
    {660.0f, 1.8825e-18f},
    {670.0f, 1.8598e-18f},
    {680.0f, 1.8979e-18f},
    {690.0f, 1.9333e-18f},
    {700.0f, 1.9684e-18f},
    {710.0f, 2.0131e-18f},
    {720.0f, 1.9776e-18f},
    {730.0f, 1.9390e-18f},
    {740.0f, 1.9472e-18f},
    {750.0f, 1.9817e-18f},
    {760.0f, 2.0810e-18f},
    {770.0f, 2.1668e-18f},
    {780.0f, 2.2296e-18f},
    {790.0f, 2.2413e-18f},
    {800.0f, 2.2365e-18f},
    {810.0f, 2.2172e-18f},
    {820.0f, 2.2134e-18f},
    {830.0f, 2.2206e-18f},
};

float
RemoteContinentalAerosol::get_absorption_cross_section(float wl) const
{
    return lut_lerp(remote_continental_absorption_cross_section, wl);
}

float
RemoteContinentalAerosol::get_scattering_cross_section(float wl) const
{
    return lut_lerp(remote_continental_scattering_cross_section, wl);
}

//------------------------------------------------------------------------------

static const LookupTable rural_absorption_cross_section = {
    {360.0f, 4.7028e-22f},
    {370.0f, 4.2239e-22f},
    {380.0f, 3.8031e-22f},
    {390.0f, 3.4321e-22f},
    {400.0f, 3.1047e-22f},
    {410.0f, 2.8146e-22f},
    {420.0f, 2.5573e-22f},
    {430.0f, 2.3284e-22f},
    {440.0f, 2.1240e-22f},
    {450.0f, 1.9415e-22f},
    {460.0f, 1.7778e-22f},
    {470.0f, 1.6309e-22f},
    {480.0f, 1.4988e-22f},
    {490.0f, 1.3798e-22f},
    {500.0f, 1.2723e-22f},
    {510.0f, 1.1750e-22f},
    {520.0f, 1.0866e-22f},
    {530.0f, 1.0063e-22f},
    {540.0f, 9.3336e-23f},
    {550.0f, 8.6685e-23f},
    {560.0f, 8.0627e-23f},
    {570.0f, 7.5084e-23f},
    {580.0f, 7.0015e-23f},
    {590.0f, 6.5363e-23f},
    {600.0f, 6.1093e-23f},
    {610.0f, 5.7175e-23f},
    {620.0f, 5.3565e-23f},
    {630.0f, 5.0236e-23f},
    {640.0f, 4.7160e-23f},
    {650.0f, 4.4318e-23f},
    {660.0f, 4.1679e-23f},
    {670.0f, 3.9233e-23f},
    {680.0f, 3.6966e-23f},
    {690.0f, 3.4860e-23f},
    {700.0f, 3.2900e-23f},
    {710.0f, 3.1085e-23f},
    {720.0f, 2.9395e-23f},
    {730.0f, 2.7817e-23f},
    {740.0f, 2.6344e-23f},
    {750.0f, 2.4966e-23f},
    {760.0f, 2.3580e-23f},
    {770.0f, 2.2292e-23f},
    {780.0f, 2.1097e-23f},
    {790.0f, 1.9986e-23f},
    {800.0f, 1.8952e-23f},
    {810.0f, 1.8028e-23f},
    {820.0f, 1.7160e-23f},
    {830.0f, 1.6343e-23f},
};

static const LookupTable rural_scattering_cross_section = {
    {360.0f, 3.5222e-22f},
    {370.0f, 3.3707e-22f},
    {380.0f, 3.2286e-22f},
    {390.0f, 3.0950e-22f},
    {400.0f, 2.9696e-22f},
    {410.0f, 2.8907e-22f},
    {420.0f, 2.8165e-22f},
    {430.0f, 2.7462e-22f},
    {440.0f, 2.6797e-22f},
    {450.0f, 2.6190e-22f},
    {460.0f, 2.6767e-22f},
    {470.0f, 2.7332e-22f},
    {480.0f, 2.7866e-22f},
    {490.0f, 2.8373e-22f},
    {500.0f, 2.8848e-22f},
    {510.0f, 2.7923e-22f},
    {520.0f, 2.7037e-22f},
    {530.0f, 2.6191e-22f},
    {540.0f, 2.5384e-22f},
    {550.0f, 2.4643e-22f},
    {560.0f, 2.4849e-22f},
    {570.0f, 2.5075e-22f},
    {580.0f, 2.5292e-22f},
    {590.0f, 2.5501e-22f},
    {600.0f, 2.5701e-22f},
    {610.0f, 2.5808e-22f},
    {620.0f, 2.5910e-22f},
    {630.0f, 2.6009e-22f},
    {640.0f, 2.6106e-22f},
    {650.0f, 2.6197e-22f},
    {660.0f, 2.6150e-22f},
    {670.0f, 2.6103e-22f},
    {680.0f, 2.6059e-22f},
    {690.0f, 2.6018e-22f},
    {700.0f, 2.5983e-22f},
    {710.0f, 2.6262e-22f},
    {720.0f, 2.6537e-22f},
    {730.0f, 2.6804e-22f},
    {740.0f, 2.7064e-22f},
    {750.0f, 2.7346e-22f},
    {760.0f, 3.0342e-22f},
    {770.0f, 3.3285e-22f},
    {780.0f, 3.6152e-22f},
    {790.0f, 3.8948e-22f},
    {800.0f, 4.1622e-22f},
    {810.0f, 4.0891e-22f},
    {820.0f, 4.0134e-22f},
    {830.0f, 3.9398e-22f},
};

float
RuralAerosol::get_absorption_cross_section(float wl) const
{
    return lut_lerp(rural_absorption_cross_section, wl);
}

float
RuralAerosol::get_scattering_cross_section(float wl) const
{
    return lut_lerp(rural_scattering_cross_section, wl);
}

//------------------------------------------------------------------------------

static const LookupTable urban_absorption_cross_section = {
    {360.0f, 2.7779e-23f},
    {370.0f, 2.4863e-23f},
    {380.0f, 2.2317e-23f},
    {390.0f, 2.0087e-23f},
    {400.0f, 1.8126e-23f},
    {410.0f, 1.6400e-23f},
    {420.0f, 1.4873e-23f},
    {430.0f, 1.3519e-23f},
    {440.0f, 1.2315e-23f},
    {450.0f, 1.1241e-23f},
    {460.0f, 1.0282e-23f},
    {470.0f, 9.4219e-24f},
    {480.0f, 8.6504e-24f},
    {490.0f, 7.9562e-24f},
    {500.0f, 7.3294e-24f},
    {510.0f, 6.7585e-24f},
    {520.0f, 6.2413e-24f},
    {530.0f, 5.7720e-24f},
    {540.0f, 5.3461e-24f},
    {550.0f, 4.9587e-24f},
    {560.0f, 4.6088e-24f},
    {570.0f, 4.2890e-24f},
    {580.0f, 3.9968e-24f},
    {590.0f, 3.7287e-24f},
    {600.0f, 3.4829e-24f},
    {610.0f, 3.2592e-24f},
    {620.0f, 3.0532e-24f},
    {630.0f, 2.8633e-24f},
    {640.0f, 2.6878e-24f},
    {650.0f, 2.5256e-24f},
    {660.0f, 2.3738e-24f},
    {670.0f, 2.2331e-24f},
    {680.0f, 2.1028e-24f},
    {690.0f, 1.9817e-24f},
    {700.0f, 1.8692e-24f},
    {710.0f, 1.7659e-24f},
    {720.0f, 1.6697e-24f},
    {730.0f, 1.5799e-24f},
    {740.0f, 1.4961e-24f},
    {750.0f, 1.4177e-24f},
    {760.0f, 1.3421e-24f},
    {770.0f, 1.2715e-24f},
    {780.0f, 1.2056e-24f},
    {790.0f, 1.1441e-24f},
    {800.0f, 1.0866e-24f},
    {810.0f, 1.0341e-24f},
    {820.0f, 9.8466e-25f},
    {830.0f, 9.3817e-25f},
};

static const LookupTable urban_scattering_cross_section = {
    {360.0f, 3.0106e-22f},
    {370.0f, 2.9042e-22f},
    {380.0f, 2.8046e-22f},
    {390.0f, 2.7112e-22f},
    {400.0f, 2.6234e-22f},
    {410.0f, 2.5446e-22f},
    {420.0f, 2.4703e-22f},
    {430.0f, 2.4001e-22f},
    {440.0f, 2.3337e-22f},
    {450.0f, 2.2710e-22f},
    {460.0f, 2.2230e-22f},
    {470.0f, 2.1775e-22f},
    {480.0f, 2.1344e-22f},
    {490.0f, 2.0933e-22f},
    {500.0f, 2.0540e-22f},
    {510.0f, 1.9991e-22f},
    {520.0f, 1.9464e-22f},
    {530.0f, 1.8960e-22f},
    {540.0f, 1.8478e-22f},
    {550.0f, 1.8019e-22f},
    {560.0f, 1.7704e-22f},
    {570.0f, 1.7405e-22f},
    {580.0f, 1.7118e-22f},
    {590.0f, 1.6841e-22f},
    {600.0f, 1.6577e-22f},
    {610.0f, 1.6341e-22f},
    {620.0f, 1.6115e-22f},
    {630.0f, 1.5898e-22f},
    {640.0f, 1.5688e-22f},
    {650.0f, 1.5484e-22f},
    {660.0f, 1.5246e-22f},
    {670.0f, 1.5015e-22f},
    {680.0f, 1.4793e-22f},
    {690.0f, 1.4577e-22f},
    {700.0f, 1.4369e-22f},
    {710.0f, 1.4224e-22f},
    {720.0f, 1.4085e-22f},
    {730.0f, 1.3951e-22f},
    {740.0f, 1.3820e-22f},
    {750.0f, 1.3697e-22f},
    {760.0f, 1.3863e-22f},
    {770.0f, 1.4027e-22f},
    {780.0f, 1.4189e-22f},
    {790.0f, 1.4348e-22f},
    {800.0f, 1.4498e-22f},
    {810.0f, 1.4303e-22f},
    {820.0f, 1.4109e-22f},
    {830.0f, 1.3920e-22f},
};

float
UrbanAerosol::get_absorption_cross_section(float wl) const
{
    return lut_lerp(urban_absorption_cross_section, wl);
}

float
UrbanAerosol::get_scattering_cross_section(float wl) const
{
    return lut_lerp(urban_scattering_cross_section, wl);
}
